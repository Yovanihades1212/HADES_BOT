const { createHash } = require('crypto')
let Reg = /(.*)([.|])([0-9]*)$/i
let handler = async function (m, { text, usedPrefix }) {
  let user = global.DATABASE._data.users[m.sender]
  if (user.registered === true) throw `
â•­â”â”â”â”â”âœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â”â”â”â”â”â•®
â”‚â‡¶ðŸ¤—â¤ï¸ð˜ð€ ð“ð„ ð„ðð‚ð”ð„ðð“ð‘ð€ð’
â”‚â‡¶ð‘ð„ð†ðˆð’ð“ð‘ð€ðƒðŽ ð€ ðŒÃ 
â”‚â‡¶ð‹ðˆð’ð“ð€ðŸ“   ðƒð€ð“ðŽð’
â”‚â‡¶ðƒð„ ð‡ð€ðƒð„ð’_ððŽð“â¤ï¸ 
â•°â”â”â”â”â”âœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â”â”â”â”â”â•¯`
  if (!Reg.test(text)) throw `
â•­â”â”â”â”â”âœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â”â”â”â”â”â•®
â”‚â‡¶  à¼´âƒŸðŸŒ¹à½¼à¹‹à£­ð‡ðšððžð¬_ð›ð¨ð­ à¼´âƒŸðŸŒ¹à½¼à¹‹à£­
â”œâ”â”â”â”â‰ªâœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â‰«â”â”â”â•¯
â”‚â‡¶ðŸ¤—ð‡ðŽð‹ð€ ð“ð„ ðˆðð•ðˆð“ð€ðŒðŽð’ 
â”‚â‡¶ð€ ð‘ð„ð†ðˆð’ð“ð‘ð€ð‘ð“ð„ ð€
â”‚â‡¶ððŽð“: ð‡ð€ðƒð„ð’_ððŽð“â¤ï¸âœ¨
â”œâ”â”â”â”â‰ªâœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â‰«â”â”â”â•¯
â”‚â‡¶ð…ð¨ð«ð¦ðšð­ð¨ ð¢ð§ðœð¨ð«ð«ðžðœð­ð¨\n
â”‚â‡¶${usedPrefix}/ð«ðžð  ðð¨ð¦ð›ð«ðž.ð„ððšð
â”‚â‡¶ð„ð£ðžð¦ð©ð¥ð¨ /ð«ðžð  ð‡ðšððžð¬.18
â•°â”â”â”â”â”âœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â”â”â”â”â”â•¯`
  let [_, name, splitter, age] = text.match(Reg)
  if (!name) throw '*_El nombre no puede estar vacÃ­o_*'
  if (!age) throw '*_La edad no puede estar vacÃ­a_*'
  user.name = name
  user.age = parseInt(age)
  user.regTime = + new Date
  user.registered = true
  let sn = createHash('md5').update(m.sender).digest('hex')
  m.reply(`
â•­â”â”â”â”â”âœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â”â”â”â”â”â•®  
â”‚â‡¶â¤ï¸ð‘ðžð ð¢ð¬ð­ð«ðšðð¨ ðœð¨ð§ Ã©ð±ð¢ð­ð¨
â”‚â‡¶ð†ð‘ð€ð‚ðˆð€ð’ ððŽð‘ðŸ¥³
â”‚â‡¶ ð‘ð„ð†ðˆð’ð“ð‘ð€ð‘ð“ð„
â”‚â‡¶ ð€ ð‡ð€ðƒð„ð’_ððŽð“âœ¨â¤ï¸
â•°â”â”â”â”â”âœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â”â”â”â”â”â•¯
â•­â”â”â”â”â”âœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â”â”â”â”â”â•®
â”‚â‡¶  à¼´âƒŸðŸŒ¹à½¼à¹‹à£­ð‡ðšððžð¬_ð›ð¨ð­ à¼´âƒŸðŸŒ¹à½¼à¹‹à£­
â”œâ”â”â”â”â‰ªâœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â‰«â”â”â”â•¯
â”‚â‡¶ðð¨ð¦ð›ð«ðž: ${name}
â”‚â‡¶ð„ððšð: ${age}
â•°â”â”â”â”â”âœ¯ð“†©áÖŸÖ¶ð“†ªâ©âœ¯â”â”â”â”â”â•¯
`.trim())
}
handler.help = ['daftar', 'reg', 'register'].map(v => v + ' <nama>.<umur>')
handler.tags = ['exp']

handler.command = /^(daftar|reg(ister)?)$/i

module.exports = handler

